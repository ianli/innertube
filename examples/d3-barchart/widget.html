<!DOCTYPE html>
<html>
<head>
	<title>D3.js Bar Chart Example - Innertube Widgets API</title>
	
	<!-- Blueprint -->
	<link rel="stylesheet" href="/innertube/assets/stylesheets/blueprint/reset.css" type="text/css" />
	<link rel="stylesheet" href="/innertube/assets/stylesheets/blueprint/typography.css" type="text/css" />

  <link rel="stylesheet" href="d3-barchart.css" type="text/css" />
</head>
<body>

<!-- Javascripts -->
<script src="http://ianli.github.com/innertube/javascripts/easyXDM-2.4.15.118/easyXDM.js"></script>
<script>
	easyXDM.DomHelper.requiresJSON("http://ianli.github.com/innertube/javascripts/easyXDM-2.4.15.118/json2.js");
</script>
<script src="http://ianli.github.com/innertube/javascripts/underscore-1.3.1.js"></script>
<script src="http://ianli.github.com/innertube/1.0.0/innertube.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
<script src="http://ianli.github.com/innertube/javascripts/backbone-0.5.3.min.js"></script>	
<script src="http://ianli.github.com/innertube/javascripts/d3.v2.js"></script>
<script src="d3-barchart.js"></script>

<script>
(function (easyXDM, _, Innertube, d3, $, undefined) {
  
  // MAIN
  // ====
	
  var model = new D3BarChartModel()
    , view = new D3BarChartView({ model: model }).render();
  
  $('body').append(view.el);
  
  
  // INNERTUBE
  // ========= 
  
  Innertube()
    .ready(function () {      
      Innertube()
        .request("date")
        .request("highlight");
    })
    .receive('date', function (year, month, day) {
      var data = [];
      for (var i = 0; i < 24; i++) {
  			data.push(Math.random() * 10);
  		}
      
      model.set({ data: data });
    })
    .receive('highlight', function (highlightObject) {
      model.set({ highlight: highlightObject });
    });
      
} (easyXDM, _, Innertube, d3, jQuery));
</script>

</body>
</html>